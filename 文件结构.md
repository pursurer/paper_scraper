# Paper Scraper - 文件结构

## 项目简介

一个用于从多个来源批量获取 AI 顶会论文元数据的 Python 工具。

## 数据来源

| 来源类型 | 支持会议 | 模块 |
|---------|---------|------|
| **OpenReview API** | ICLR, ICML, NeurIPS | `scraper.py`, `paper.py`, `venue.py` |
| **网页爬取** | AAAI, IJCAI, ACL, EMNLP, NAACL, AISTATS | `web_scraper.py` |
| **PDF 提取** | AAMAS | `pdf_extractor.py` |

## 文件结构

```
论文获取/
├── paper_scraper/              # 核心 Python 包
│   ├── __init__.py             # 包入口，定义 SOURCES 和导出
│   ├── __main__.py             # CLI 命令行入口
│   │
│   ├── # OpenReview 来源
│   ├── scraper.py              # Scraper 主类
│   ├── paper.py                # 论文获取逻辑
│   ├── venue.py                # Venue 处理
│   │
│   ├── # 网页爬取来源
│   ├── web_scraper.py          # AAAI/IJCAI/ACL 等爬虫
│   │
│   ├── # PDF 提取来源
│   ├── pdf_extractor.py        # PDF 元数据提取
│   │
│   ├── # 通用模块
│   ├── extractor.py            # 字段提取器
│   ├── filters.py              # 关键词过滤器
│   └── utils.py                # 通用工具函数
│
├── config/                     # 配置目录
│   ├── __init__.py             # Config 类
│   └── config.example.py       # 配置模板
│
├── tests/                      # 测试文件 (293 个测试)
│   ├── __init__.py
│   ├── test_package.py         # 包测试
│   ├── test_utils.py           # 工具函数测试
│   ├── test_extractor.py       # 提取器测试
│   ├── test_filters.py         # 过滤器测试
│   ├── test_venue.py           # Venue 测试
│   ├── test_paper.py           # 论文获取测试
│   ├── test_scraper.py         # Scraper 测试
│   ├── test_web_scraper.py     # 网页爬取测试
│   ├── test_pdf_extractor.py   # PDF 提取测试
│   ├── test_cli.py             # CLI 测试
│   └── test_config.py          # 配置测试
│
├── scripts/                    # 脚本目录
│
├── 项目指南.md                  # TDD 行动指南
├── 文件结构.md                  # 本文件
├── AGENTS.md                   # AI Agent 开发指南
├── README.md                   # 项目说明
├── requirements.txt            # Python 依赖
└── .gitignore                  # Git 忽略规则
```

## 模块说明

### 核心模块

| 模块 | 职责 | 主要函数/类 |
|------|------|-------------|
| `__init__.py` | 包入口 | `SOURCES`, 各模块导出 |
| `__main__.py` | CLI 入口 | `main()`, `create_parser()` |
| `scraper.py` | OpenReview 主类 | `Scraper`, `create_scraper()` |
| `paper.py` | 论文获取 | `get_papers()`, `deduplicate_papers()` |
| `venue.py` | Venue 处理 | `get_venues()`, `group_venues()` |
| `web_scraper.py` | 网页爬取 | `scrape_ijcai()`, `scrape_aaai()`, ... |
| `pdf_extractor.py` | PDF 提取 | `extract_aamas_metadata()`, `process_pdf()` |
| `extractor.py` | 字段提取 | `Extractor` |
| `filters.py` | 关键词过滤 | `title_filter()`, `abstract_filter()` |
| `utils.py` | 工具函数 | `to_csv()`, `get_client()`, `retry_with_backoff()` |

### 配置模块

| 模块 | 职责 | 主要函数/类 |
|------|------|-------------|
| `config/__init__.py` | 配置管理 | `Config`, `get_config()` |
| `config/config.example.py` | 配置模板 | `EMAIL`, `PASSWORD` |

## 依赖项

```
# OpenReview 来源
openreview-py>=0.6.0

# 网页爬取来源
beautifulsoup4>=4.9.0
requests>=2.25.0
html5lib>=1.1
python-slugify>=4.0.0

# PDF 提取来源
PyMuPDF>=1.18.0  # 或 pdfminer.six

# 通用
dill>=0.3.0
thefuzz>=0.20.0
pytest>=7.0.0
```

## API 契约

### Scraper 类 (OpenReview)
```python
class Scraper:
    def __init__(
        self,
        conferences: List[str],      # 会议名称
        years: List[str],            # 年份
        keywords: List[str],         # 过滤关键词
        extractor: Extractor,        # 字段提取器
        fpath: str,                  # 输出路径
        ...
    )
    
    def add_filter(self, filter_fn) -> Self
    def scrape(self) -> None
```

### 网页爬取函数
```python
def scrape_conference(
    conference: str,               # 会议名称
    year: int,                     # 年份
    output_path: Optional[str],    # 输出路径
    verbose: bool                  # 打印日志
) -> List[Dict[str, Any]]
```

### Config 类
```python
class Config:
    openreview_email: Optional[str]
    openreview_password: Optional[str]
    request_delay_min: float
    request_delay_max: float
    request_timeout: int
    request_retries: int
    output_dir: str
    verbose: bool
    has_credentials: bool
```

## CSV 输出格式

| 字段 | 说明 |
|------|------|
| `id` | 唯一标识 (会议名_年份_序号) |
| `title` | 论文标题 |
| `keywords` | 关键词列表 |
| `abstract` | 摘要 |
| `pdf` | PDF 链接 |
| `forum` | 论文页面链接 |
| `year` | 年份 |
| `presentation_type` | 展示类型 |
